{% ckan_extends %}

{% block extra_fields %}
{% if g.userobj.sysadmin and data.state == 'deleted' %}
  {% call form.checkbox('activate_user', label=_('Reactivate User'), id='activate_user', value=True, checked=false) %}
  {% set helper_text = _('This account is deactivated, if you want to reactivate it, please click on checkbox.') %}
  {{ form.info(helper_text, classes='info-help-tight') }}
  {% endcall %}
{% endif %}

{% if h.security_enable_totp() %}
  <fieldset>
    <legend>{{_('Two factor authentication')}}</legend>
    {% link_for _('Manage two factor authentication'), controller='mfa_user', action='configure_mfa', id=data.id, class_='btn btn-default pull-left', icon='cog' %}
  </fieldset>
{% endif %}

{% endblock %}

{% block change_password %} {# Override this block to add the password_rules_hint() helper method #}
    <fieldset>
        <legend>{{ _('Change password') }}</legend>
        {{ form.input('old_password',
                      type='password',
                      label=_('Old Password'),
                      id='field-password-old',
                      value=data.oldpassword,
                      error=errors.oldpassword,
                      classes=['control-medium'],
                      attrs={'autocomplete': 'off', 'class': 'form-control'}
                      ) }}

        <p>{{ h.password_rules_hint() }}</p>
        {{ form.input('password1', type='password', label=_('Password'), id='field-password', value=data.password1, error=errors.password1, classes=['control-medium'], attrs={'autocomplete': 'off', 'class': 'form-control'} ) }}

        {{ form.input('password2', type='password', label=_('Confirm Password'), id='field-password-confirm', value=data.password2, error=errors.password2, classes=['control-medium'], attrs={'autocomplete': 'off', 'class': 'form-control'}) }}
    </fieldset>
{% endblock %}
